(function(a){a.ajaxPrefilter(function(a){if(a.iframe)return"iframe"});a.ajaxTransport("iframe",function(b){function d(){a(h).each(function(){this.remove()});a(j).each(function(){this.disabled=false});c.attr("action",f||"").attr("target",k||"").attr("enctype",l||"");g.attr("src","javascript:false;").remove()}var c=null,g=null,f=null,k=null,l=null,h=[],j=[],i=a(b.files).filter(":file:enabled");b.dataTypes.shift();if(i.length)return i.each(function(){c!==null&&this.form!==c&&jQuery.error("All file fields must belong to the same form");
c=this.form}),c=a(c),f=c.attr("action"),k=c.attr("target"),l=c.attr("enctype"),c.find(":input:not(:submit)").each(function(){if(!this.disabled&&(this.type!="file"||i.index(this)<0))this.disabled=true,j.push(this)}),typeof b.data==="string"&&b.data.length>0&&jQuery.error("data must not be serialized"),a.each(b.data||{},function(b,d){if(a.isPlainObject(d))b=d.name,d=d.value;h.push(a("<input type='hidden'>").attr("name",b).attr("value",d).appendTo(c))}),h.push(a("<input type='hidden' name='X-Requested-With'>").attr("value",
"IFrame").appendTo(c)),accepts=b.dataTypes[0]&&b.accepts[b.dataTypes[0]]?b.accepts[b.dataTypes[0]]+(b.dataTypes[0]!=="*"?", */*; q=0.01":""):b.accepts["*"],h.push(a("<input type='hidden' name='X-Http-Accept'>").attr("value",accepts).appendTo(c)),{send:function(f,h){g=a("<iframe src='javascript:false;' name='iframe-"+a.now()+"' style='display:none'></iframe>");g.bind("load",function(){g.unbind("load").bind("load",function(){var a=this.contentWindow?this.contentWindow.document:this.contentDocument?
this.contentDocument:this.document,a=a.documentElement?a.documentElement:a.body,b=a.getElementsByTagName("textarea")[0],c=b?b.getAttribute("data-type"):null,f=b?parseInt(b.getAttribute("response-code")):200;h(f,"OK",{text:c?b.value:a?a.innerHTML:null},"Content-Type: "+(c||"text/html"));setTimeout(d,50)});c.attr("action",b.url).attr("target",g.attr("name")).attr("enctype","multipart/form-data").get(0).submit()});g.insertAfter(c)},abort:function(){g!==null&&(g.unbind("load").attr("src","javascript:false;"),
d())}}})})(jQuery);
(function(a){var b;a.remotipart=b={setup:function(d){d.one("ajax:beforeSend.remotipart",function(c,g,f){delete f.beforeSend;f.iframe=true;f.files=a(a.rails.fileInputSelector,d);f.data=d.serializeArray();f.processData=false;if(f.dataType===void 0)f.dataType="script *";f.data.push({name:"remotipart_submitted",value:true});a.rails.fire(d,"ajax:remotipartSubmit",[g,f])&&a.rails.ajax(f);b.teardown(d);return false}).data("remotipartSubmitted",true)},teardown:function(a){a.unbind("ajax:beforeSend.remotipart").removeData("remotipartSubmitted")}};a("form").live("ajax:aborted:file",
function(){var d=a(this);b.setup(d);if(!a.support.submitBubbles&&a().jquery<"1.7"&&a.rails.callFormSubmitBindings(d)===false)return a.rails.stopEverything(e);a.rails.handleRemote(d);return false})})(jQuery);
